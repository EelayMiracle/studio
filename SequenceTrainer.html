<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢—Ä–µ–Ω–∞–∂–µ—Ä –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Arial', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.1)), /* –ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ */
                url('f1.jpg') center/cover no-repeat; /* –§–æ–Ω–æ–≤–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ */
            z-index: -2;
        }

        /* –ü–æ–≤–µ—Ä—Ö —Ñ–æ–Ω–æ–≤–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–æ–±–∞–≤–∏–º –≤–∞—à –≥—Ä–∞–¥–∏–µ–Ω—Ç —Å –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å—é */
        body::after {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, rgba(110, 142, 251, 0.8), rgba(167, 119, 227, 0.3));
            z-index: -1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 20px;
        }

        /* –°—Ç–∏–ª—å –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥" */
        .back-button {
            display: inline-flex;
            justify-content: center;
            align-items: center;
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
            font-size: 24px;
            border-radius: 50%;
            text-decoration: none;
            transition: all 0.3s;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            border: none;
            cursor: pointer;
        }

        .back-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.3);
        }

        .settings-panel {
            background: #f8f9fa;
            padding: 30px;
            border-bottom: 1px solid #e9ecef;
        }

        .settings-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .setting-group {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .setting-group h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .setting-item {
            margin-bottom: 15px;
        }

        .setting-item label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #555;
        }

        .setting-item input, .setting-item select {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }

        .setting-item input:focus, .setting-item select:focus {
            outline: none;
            border-color: #4ecdc4;
        }

        .emoji-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .emoji-option {
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 24px;
        }

        .emoji-option:hover {
            transform: scale(1.1);
            border-color: #4ecdc4;
        }

        .emoji-option.selected {
            background: #4ecdc4;
            border-color: #4ecdc4;
            color: white;
        }

        .control-buttons {
            text-align: center;
            margin-top: 20px;
        }

        .btn {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 25px;
            font-size: 18px;
            cursor: pointer;
            margin: 0 10px;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
        }

        .game-area {
            padding: 30px;
        }

        .sequence-container {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
        }

        .sequence-container h2 {
            margin-bottom: 30px;
        }

        .sequence {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-bottom: 20px;
        }

        .sequence-item {
            width: 60px;
            height: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
            border: 3px solid #ddd;
            border-radius: 10px;
            font-size: 30px;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
        }

        .sequence-item:hover {
            transform: scale(1.1);
            border-color: #4ecdc4;
        }

        .sequence-item.gap {
            background: #ffeb3b;
            border-color: #ff9800;
            position: relative;
        }

        .sequence-item.gap::after {
            content: '?';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 24px;
            font-weight: bold;
            color: #ff9800;
        }

        .sequence-item.gap.empty {
            background: #f5f5f5;
            border-color: #ccc;
            border-style: dashed;
        }

        .sequence-item.gap.empty::after {
            content: '';
        }

        .sequence-item.selected {
            background: #ff9800 !important;
            border-color: #f57c00 !important;
            transform: scale(1.1);
            box-shadow: 0 0 15px rgba(255, 152, 0, 0.5);
        }

        .sequence-item.filled {
            background: #4caf50;
            border-color: #2e7d32;
            color: white;
        }

        .sequence-item.incorrect-gap {
            background: #f44336;
            border-color: #d32f2f;
            color: white;
        }

        .choice-panel {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: none;
        }

        .choice-panel h3 {
            margin-bottom: 15px;
            color: #333;
        }

        .choice-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }

        .choice-option {
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 24px;
            background: white;
        }

        .choice-option:hover {
            transform: scale(1.1);
            border-color: #4ecdc4;
            background: #f0f8ff;
        }

        .questions-section {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 15px;
            margin-top: 30px;
        }

        .questions-section h2 {
            color: #333;
            margin-bottom: 20px;
            text-align: center;
        }

        .questions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .question-item {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .question-text {
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }

        .question-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            margin-bottom: 10px;
        }

        .question-result {
            padding: 10px;
            border-radius: 5px;
            text-align: center;
            font-weight: bold;
            display: none;
        }

        .question-result.correct {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }

        .question-result.incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }

        .question-options {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 10px;
        }

        .question-option {
            padding: 8px 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 18px;
            background: white;
            min-width: 40px;
            text-align: center;
        }

        .question-option:hover {
            transform: scale(1.05);
            border-color: #4ecdc4;
            background: #f0f8ff;
        }

        .question-option.selected {
            background: #4ecdc4;
            border-color: #2e7d32;
            color: white;
        }

        .question-option.correct {
            background: #4caf50;
            border-color: #2e7d32;
            color: white;
        }

        .question-option.incorrect {
            background: #f44336;
            border-color: #d32f2f;
            color: white;
        }

        .stats {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            text-align: center;
        }

        .stats h3 {
            color: #333;
            margin-bottom: 15px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
        }

        .stat-item {
            padding: 15px;
            background: #f8f9fa;
            border-radius: 8px;
        }

        .stat-value {
            font-size: 24px;
            font-weight: bold;
            color: #4ecdc4;
        }

        .stat-label {
            color: #666;
            font-size: 14px;
        }

        @media (max-width: 768px) {
            .settings-grid {
                grid-template-columns: 1fr;
            }
            
            .sequence {
                gap: 10px;
            }
            
            .sequence-item {
                width: 50px;
                height: 50px;
                font-size: 24px;
            }
            
            .questions-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üî¢ –¢—Ä–µ–Ω–∞–∂–µ—Ä –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–µ–π<a href="index.html" class="back-button"> ‚Üê</a></h1>
            <p>–ò–∑—É—á–∞–π—Ç–µ –∑–∞–∫–æ–Ω–æ–º–µ—Ä–Ω–æ—Å—Ç–∏ —Å –ø–æ–º–æ—â—å—é —ç–º–æ–¥–∑–∏ —Ñ–∏–≥—É—Ä!</p>
        </div>

        <div class="settings-panel">
            <h2>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</h2>
            <div class="settings-grid">
                <div class="setting-group">
                    <h3>üîÑ –†–∞–∑–º–µ—Ä —Ü–∏–∫–ª–∞</h3>
                    <div class="setting-item">
                        <label for="minCycleLength">–ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Ü–∏–∫–ª–∞:</label>
                        <input type="number" id="minCycleLength" value="3" min="2" max="15">
                    </div>
                    <div class="setting-item">
                        <label for="maxCycleLength">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Ü–∏–∫–ª–∞:</label>
                        <input type="number" id="maxCycleLength" value="8" min="2" max="20">
                    </div>
                    <div class="setting-item">
                        <label for="visibleElements">–ü–æ–∫–∞–∑–∞—Ç—å —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ:</label>
                        <input type="number" id="visibleElements" value="15" min="5" max="30">
                    </div>
                </div>

                <div class="setting-group">
                    <h3>üé® –≠–ª–µ–º–µ–Ω—Ç—ã –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h3>
                    <div class="setting-item">
                        <label>–í—ã–±–µ—Ä–∏—Ç–µ —ç–º–æ–¥–∑–∏ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:</label>
                        <div class="emoji-selector" id="emojiSelector">
                            <div class="emoji-option selected" data-emoji="üîµ">üîµ</div>
                            <div class="emoji-option selected" data-emoji="üü°">üü°</div>
                            <div class="emoji-option selected" data-emoji="üü¢">üü¢</div>
                            <div class="emoji-option" data-emoji="üüß">üüß</div>
                            <div class="emoji-option" data-emoji="üü¶">üü¶</div>
                            <div class="emoji-option" data-emoji="üü®">üü®</div>
                            <div class="emoji-option" data-emoji="üü™">üü™</div>
                            <div class="emoji-option" data-emoji="üü£">üü£</div>
                            <div class="emoji-option" data-emoji="üü†">üü†</div>
                            <div class="emoji-option" data-emoji="üíö">üíö</div>
                            <div class="emoji-option" data-emoji="üíú">üíú</div>
                            <div class="emoji-option" data-emoji="‚ù§Ô∏è">‚ù§Ô∏è</div>
                            <div class="emoji-option" data-emoji="üíõ">üíõ</div>
                        </div>
                    </div>
                    <div class="setting-item">
                        <label for="uniqueCount">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤:</label>
                        <input type="number" id="uniqueCount" value="3" min="2" max="10">
                    </div>
                </div>

                <div class="setting-group">
                    <h3>‚ùì –ü—Ä–æ–ø—É—Å–∫–∏ –≤ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h3>
                    <div class="setting-item">
                        <label for="gapCount">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤:</label>
                        <input type="number" id="gapCount" value="5" min="1" max="20">
                    </div>
                    <div class="setting-item">
                        <label for="minInterval">–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –ø—Ä–æ–ø—É—Å–∫–∞–º–∏:</label>
                        <input type="number" id="minInterval" value="2" min="1" max="10">
                    </div>
                    <div class="setting-item">
                        <label for="maxInterval">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª –º–µ–∂–¥—É –ø—Ä–æ–ø—É—Å–∫–∞–º–∏:</label>
                        <input type="number" id="maxInterval" value="5" min="1" max="15">
                    </div>
                    <div class="setting-item">
                        <label for="gapStyle">–°—Ç–∏–ª—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤:</label>
                        <select id="gapStyle">
                            <option value="empty">–ü—É—Å—Ç—ã–µ –∫–ª–µ—Ç–æ—á–∫–∏</option>
                            <option value="question">–ó–Ω–∞–∫–∏ –≤–æ–ø—Ä–æ—Å–∞</option>
                        </select>
                    </div>
                </div>

                <div class="setting-group">
                    <h3>‚ùì –í–æ–ø—Ä–æ—Å—ã –æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h3>
                    <div class="setting-item">
                        <label for="questionMin">–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä —ç–ª–µ–º–µ–Ω—Ç–∞:</label>
                        <input type="number" id="questionMin" value="20" min="1" max="100">
                    </div>
                    <div class="setting-item">
                        <label for="questionMax">–ú–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –Ω–æ–º–µ—Ä —ç–ª–µ–º–µ–Ω—Ç–∞:</label>
                        <input type="number" id="questionMax" value="50" min="1" max="100">
                    </div>
                    <div class="setting-item">
                        <label for="questionCount">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≤–æ–ø—Ä–æ—Å–æ–≤:</label>
                        <input type="number" id="questionCount" value="6" min="1" max="10">
                    </div>
                </div>
            </div>

            <div class="control-buttons">
                <button class="btn" onclick="generateSequence()">üé≤ –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å</button>
                <button class="btn" onclick="showAnswers()">üëÅÔ∏è –ü–æ–∫–∞–∑–∞—Ç—å –æ—Ç–≤–µ—Ç—ã</button>
                <button class="btn" onclick="resetGame()">üîÑ –°–±—Ä–æ—Å–∏—Ç—å</button>
            </div>
        </div>

        <div class="game-area">
            <div class="sequence-container">
                <h2>üîç –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å</h2>
                <div class="sequence" id="sequenceContainer">
                    <!-- –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∑–¥–µ—Å—å -->
                </div>
                
                <div class="choice-panel" id="choicePanel">
                    <h3>–í—ã–±–µ—Ä–∏—Ç–µ —ç–ª–µ–º–µ–Ω—Ç –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏:</h3>
                    <div class="choice-options" id="choiceOptions">
                        <!-- –í–∞—Ä–∏–∞–Ω—Ç—ã –≤—ã–±–æ—Ä–∞ –±—É–¥—É—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </div>

            <div class="questions-section">
                <h2>‚ùì –í–æ–ø—Ä–æ—Å—ã –æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏</h2>
                <div class="questions-grid" id="questionsContainer">
                    <!-- –í–æ–ø—Ä–æ—Å—ã –±—É–¥—É—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã –∑–¥–µ—Å—å -->
                </div>
            </div>

            <div class="stats" id="statsContainer">
                <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h3>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" id="correctAnswers">0</div>
                        <div class="stat-label">–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="totalQuestions">0</div>
                        <div class="stat-label">–í—Å–µ–≥–æ –≤–æ–ø—Ä–æ—Å–æ–≤</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="filledGaps">0</div>
                        <div class="stat-label">–ó–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–ø—É—Å–∫–æ–≤</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="totalGaps">0</div>
                        <div class="stat-label">–í—Å–µ–≥–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤</div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentSequence = [];
        let selectedEmojis = [];
        let gapPositions = []; // –¢–µ–ø–µ—Ä—å —ç—Ç–æ –º–∞—Å—Å–∏–≤ –ø–æ–∑–∏—Ü–∏–π –≤ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
        let currentGapIndex = -1;
        let questions = [];
        let correctAnswers = 0;
        let filledGaps = 0;
        let gapAnswers = {}; // –•—Ä–∞–Ω–∏—Ç –æ—Ç–≤–µ—Ç—ã –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–æ–ø—É—Å–∫–∞

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            initializeEmojiSelector();
            // –ù–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –∂–¥–µ–º –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏
        });

        function initializeEmojiSelector() {
            const emojiOptions = document.querySelectorAll('.emoji-option');
            emojiOptions.forEach(option => {
                option.addEventListener('click', function() {
                    this.classList.toggle('selected');
                    updateSelectedEmojis();
                });
            });
            updateSelectedEmojis();
        }

        function updateSelectedEmojis() {
            selectedEmojis = Array.from(document.querySelectorAll('.emoji-option.selected'))
                .map(option => option.dataset.emoji);
        }

        function testCycleLogic() {
            console.log('=== –¢–ï–°–¢ –õ–û–ì–ò–ö–ò –¶–ò–ö–õ–ê ===');
            const testCycle = ['üîµ', 'üü°', 'üü¢'];
            console.log('–¢–µ—Å—Ç–æ–≤—ã–π —Ü–∏–∫–ª:', testCycle);
            
            for (let pos = 1; pos <= 10; pos++) {
                const correctAnswer = testCycle[(pos - 1) % testCycle.length];
                console.log(`–ü–æ–∑–∏—Ü–∏—è ${pos}: (${pos} - 1) % ${testCycle.length} = ${(pos - 1) % testCycle.length} ‚Üí ${correctAnswer}`);
            }
            console.log('=== –ö–û–ù–ï–¶ –¢–ï–°–¢–ê ===');
        }

        function generateSequence() {
            console.log('–ù–∞—á–∏–Ω–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏...');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —ç–º–æ–¥–∑–∏
            updateSelectedEmojis();
            console.log('–í—ã–±—Ä–∞–Ω–Ω—ã–µ —ç–º–æ–¥–∑–∏:', selectedEmojis);
            
            if (selectedEmojis.length === 0) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —ç–º–æ–¥–∑–∏!');
                return;
            }
            
            // –ü–æ–ª—É—á–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            const minCycleLength = parseInt(document.getElementById('minCycleLength').value);
            const maxCycleLength = parseInt(document.getElementById('maxCycleLength').value);
            const uniqueCount = parseInt(document.getElementById('uniqueCount').value);
            const gapCount = parseInt(document.getElementById('gapCount').value);
            const visibleElements = parseInt(document.getElementById('visibleElements').value);
            const minInterval = parseInt(document.getElementById('minInterval').value);
            const maxInterval = parseInt(document.getElementById('maxInterval').value);

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–ª—É—á–∞–π–Ω—É—é –¥–ª–∏–Ω—É —Ü–∏–∫–ª–∞
            const cycleLength = Math.floor(Math.random() * (maxCycleLength - minCycleLength + 1)) + minCycleLength;
            console.log('–ù–∞—Å—Ç—Ä–æ–π–∫–∏:', {minCycleLength, maxCycleLength, cycleLength, uniqueCount, gapCount, visibleElements, minInterval, maxInterval});

            // –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ —ç–º–æ–¥–∑–∏ –¥–ª—è —Ü–∏–∫–ª–∞
            const shuffledEmojis = [...selectedEmojis].sort(() => Math.random() - 0.5);
            const usedEmojis = shuffledEmojis.slice(0, Math.min(uniqueCount, selectedEmojis.length));
            console.log('–ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ —ç–º–æ–¥–∑–∏:', usedEmojis);
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ü–∏–∫–ª (–ø–∞—Ç—Ç–µ—Ä–Ω) - –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤
            currentSequence = [];
            
            // –°–Ω–∞—á–∞–ª–∞ –¥–æ–±–∞–≤–ª—è–µ–º –≤—Å–µ —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã
            for (let i = 0; i < usedEmojis.length; i++) {
                currentSequence.push(usedEmojis[i]);
            }
            
            // –ó–∞—Ç–µ–º –∑–∞–ø–æ–ª–Ω—è–µ–º –æ—Å—Ç–∞–≤—à–∏–µ—Å—è –ø–æ–∑–∏—Ü–∏–∏ —Å–ª—É—á–∞–π–Ω—ã–º–∏ —ç–ª–µ–º–µ–Ω—Ç–∞–º–∏ –∏–∑ —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–Ω—ã—Ö
            for (let i = usedEmojis.length; i < cycleLength; i++) {
                currentSequence.push(usedEmojis[Math.floor(Math.random() * usedEmojis.length)]);
            }
            
            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º —Ü–∏–∫–ª, —á—Ç–æ–±—ã —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –Ω–µ –±—ã–ª–∏ –≤ –Ω–∞—á–∞–ª–µ
            currentSequence = currentSequence.sort(() => Math.random() - 0.5);
            
            console.log('–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ü–∏–∫–ª:', currentSequence);
            console.log('–£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —ç–ª–µ–º–µ–Ω—Ç—ã –≤ —Ü–∏–∫–ª–µ:', [...new Set(currentSequence)]);
            console.log('–û–∂–∏–¥–∞–ª–æ—Å—å —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤:', uniqueCount);
            console.log('–ü–æ–ª—É—á–∏–ª–æ—Å—å —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö —ç–ª–µ–º–µ–Ω—Ç–æ–≤:', [...new Set(currentSequence)].length);

            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–æ–∑–∏—Ü–∏–∏ –ø—Ä–æ–ø—É—Å–∫–æ–≤ —Å —Å–ª—É—á–∞–π–Ω—ã–º–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏
            gapPositions = [];
            gapAnswers = {};
            
            let currentPosition = 0;
            for (let i = 0; i < gapCount && currentPosition < visibleElements; i++) {
                // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª
                const interval = Math.floor(Math.random() * (maxInterval - minInterval + 1)) + minInterval;
                currentPosition += interval;
                
                if (currentPosition < visibleElements) {
                    gapPositions.push(currentPosition);
                    gapAnswers[currentPosition] = null; // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ–ø—É—Å–∫–∞
                }
            }
            
            console.log('–ü–æ–∑–∏—Ü–∏–∏ –ø—Ä–æ–ø—É—Å–∫–æ–≤:', gapPositions);

            // –û—Ç–æ–±—Ä–∞–∂–∞–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å
            displaySequence();
            
            // –¢–µ—Å—Ç–∏—Ä—É–µ–º –ª–æ–≥–∏–∫—É —Ü–∏–∫–ª–∞
            testCycleLogic();
            
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –≤–æ–ø—Ä–æ—Å—ã
            generateQuestions();
            
            // –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
            correctAnswers = 0;
            filledGaps = 0;
            updateStats();
            
            console.log('–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞!');
        }

        function displaySequence() {
            const sequenceDiv = document.querySelector('.sequence');
            sequenceDiv.innerHTML = '';

            const visibleElements = parseInt(document.getElementById('visibleElements').value);
            const cycleLength = currentSequence.length;
            const gapStyle = document.getElementById('gapStyle').value;

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∑–∞–¥–∞–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –∏–∑ –±–µ—Å–∫–æ–Ω–µ—á–Ω–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
            for (let i = 0; i < visibleElements; i++) {
                const item = document.createElement('div');
                item.className = 'sequence-item';
                
                // –í—ã—á–∏—Å–ª—è–µ–º –ø–æ–∑–∏—Ü–∏—é –≤ —Ü–∏–∫–ª–µ
                const cyclePosition = i % cycleLength;
                
                if (gapPositions.includes(i)) {
                    // –≠—Ç–æ –ø—Ä–æ–ø—É—Å–∫ –≤ –æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                    item.classList.add('gap');
                    item.onclick = () => selectGap(i);
                    
                    // –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∏–ª—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Ç–∏–ø–∞
                    if (gapStyle === 'empty') {
                        item.classList.add('empty');
                    }
                    // –î–ª—è –∑–Ω–∞–∫–æ–≤ –≤–æ–ø—Ä–æ—Å–∞ —Å—Ç–∏–ª—å —É–∂–µ –∑–∞–¥–∞–Ω –≤ CSS
                    
                    // –ï—Å–ª–∏ —É–∂–µ –µ—Å—Ç—å –æ—Ç–≤–µ—Ç –¥–ª—è —ç—Ç–æ–≥–æ –ø—Ä–æ–ø—É—Å–∫–∞, –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –µ–≥–æ
                    if (gapAnswers[i] !== null && gapAnswers[i] !== undefined) {
                        item.textContent = gapAnswers[i];
                        item.classList.remove('gap', 'empty');
                        
                        // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞
                        const correctAnswer = currentSequence[(i + 1 - 1) % cycleLength]; // i+1 –ø–æ—Ç–æ–º—É —á—Ç–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 0, –Ω–æ –ø–æ–∑–∏—Ü–∏–∏ —Å 1
                        const isCorrect = gapAnswers[i] === correctAnswer;
                        
                        if (isCorrect) {
                            item.classList.add('filled');
                            item.onclick = null;
                        } else {
                            item.classList.add('incorrect-gap');
                            item.onclick = () => selectGap(i);
                        }
                    }
                } else {
                    // –û–±—ã—á–Ω—ã–π —ç–ª–µ–º–µ–Ω—Ç –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
                    item.textContent = currentSequence[cyclePosition];
                }
                
                sequenceDiv.appendChild(item);
            }

            // –î–æ–±–∞–≤–ª—è–µ–º —Ç—Ä–æ–µ—Ç–æ—á–∏–µ, –ø–æ–∫–∞–∑—ã–≤–∞—è —á—Ç–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –±–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è
            const ellipsis = document.createElement('div');
            ellipsis.textContent = '...';
            ellipsis.style.fontSize = '24px';
            ellipsis.style.fontWeight = 'bold';
            ellipsis.style.color = '#666';
            ellipsis.style.display = 'flex';
            ellipsis.style.alignItems = 'center';
            ellipsis.style.justifyContent = 'center';
            sequenceDiv.appendChild(ellipsis);
        }

        function selectGap(displayIndex) {
            console.log('–í—ã–±—Ä–∞–Ω –ø—Ä–æ–ø—É—Å–∫:', displayIndex);
            // –£–±–∏—Ä–∞–µ–º –≤—ã–¥–µ–ª–µ–Ω–∏–µ —Å –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤—ã–±—Ä–∞–Ω–Ω–æ–π –∫–ª–µ—Ç–∫–∏
            const previousSelected = document.querySelector('.sequence-item.selected');
            if (previousSelected) {
                previousSelected.classList.remove('selected');
            }
            
            // –í—ã–¥–µ–ª—è–µ–º —Ç–µ–∫—É—â—É—é –≤—ã–±—Ä–∞–Ω–Ω—É—é –∫–ª–µ—Ç–∫—É
            const sequenceItems = document.querySelectorAll('.sequence-item');
            if (sequenceItems[displayIndex]) {
                sequenceItems[displayIndex].classList.add('selected');
            }
            
            currentGapIndex = displayIndex;
            showChoicePanel();
        }

        function showChoicePanel() {
            console.log('–ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å –≤—ã–±–æ—Ä–∞ –¥–ª—è –ø—Ä–æ–ø—É—Å–∫–∞:', currentGapIndex);
            const panel = document.getElementById('choicePanel');
            const options = document.getElementById('choiceOptions');
            
            // –û—á–∏—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã
            options.innerHTML = '';
            
            // –î–æ–±–∞–≤–ª—è–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –≤—ã–±–æ—Ä–∞
            selectedEmojis.forEach(emoji => {
                const option = document.createElement('div');
                option.className = 'choice-option';
                option.textContent = emoji;
                option.onclick = () => {
                    console.log('–ù–∞–∂–∞–ª–∏ –Ω–∞ –≤–∞—Ä–∏–∞–Ω—Ç:', emoji);
                    fillGap(emoji);
                };
                options.appendChild(option);
            });
            
            panel.style.display = 'block';
        }

        function fillGap(emoji) {
            if (currentGapIndex >= 0) {
                console.log('–ó–∞–ø–æ–ª–Ω—è–µ–º –ø—Ä–æ–ø—É—Å–∫:', currentGapIndex, '—ç–º–æ–¥–∑–∏:', emoji);
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –æ—Ç–≤–µ—Ç–∞
                const cycleLength = currentSequence.length;
                const correctAnswer = currentSequence[(currentGapIndex + 1 - 1) % cycleLength]; // currentGapIndex+1 –ø–æ—Ç–æ–º—É —á—Ç–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å 0, –Ω–æ –ø–æ–∑–∏—Ü–∏–∏ —Å 1
                const isCorrect = emoji === correctAnswer;
                console.log('–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç:', correctAnswer, '–ü—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏:', isCorrect);
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                const sequenceItems = document.querySelectorAll('.sequence-item');
                if (sequenceItems[currentGapIndex]) {
                    sequenceItems[currentGapIndex].textContent = emoji;
                    sequenceItems[currentGapIndex].classList.remove('gap', 'empty', 'selected', 'incorrect-gap', 'filled');
                    
                    if (isCorrect) {
                        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
                        gapAnswers[currentGapIndex] = emoji;
                        sequenceItems[currentGapIndex].classList.add('filled');
                        sequenceItems[currentGapIndex].onclick = null;
                        
                        // –£–±–∏—Ä–∞–µ–º –ø–æ–∑–∏—Ü–∏—é –∏–∑ —Å–ø–∏—Å–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤
                        gapPositions.splice(gapPositions.indexOf(currentGapIndex), 1);
                        filledGaps++;
                    } else {
                        // –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –∫—Ä–∞—Å–Ω—ã–º, –Ω–æ –æ—Å—Ç–∞–≤–ª—è–µ–º –∫–ª–∏–∫–∞–±–µ–ª—å–Ω—ã–º
                        sequenceItems[currentGapIndex].classList.add('incorrect-gap');
                        sequenceItems[currentGapIndex].onclick = () => selectGap(currentGapIndex);
                        // –ù–ï —Å–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –≤ gapAnswers
                    }
                }
                
                // –°–∫—Ä—ã–≤–∞–µ–º –ø–∞–Ω–µ–ª—å –≤—ã–±–æ—Ä–∞ —Ç–æ–ª—å–∫–æ –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
                if (isCorrect) {
                    document.getElementById('choicePanel').style.display = 'none';
                    currentGapIndex = -1;
                } else {
                    // –î–ª—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –æ—Å—Ç–∞–≤–ª—è–µ–º –ø–∞–Ω–µ–ª—å –æ—Ç–∫—Ä—ã—Ç–æ–π
                    // currentGapIndex –æ—Å—Ç–∞–µ—Ç—Å—è —Ç–µ–º –∂–µ, —á—Ç–æ–±—ã –º–æ–∂–Ω–æ –±—ã–ª–æ –≤—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–π –≤–∞—Ä–∏–∞–Ω—Ç
                }
                
                updateStats();
            }
        }

        function generateQuestions() {
            const questionMin = parseInt(document.getElementById('questionMin').value);
            const questionMax = parseInt(document.getElementById('questionMax').value);
            const questionCount = parseInt(document.getElementById('questionCount').value);
            
            questions = [];
            const container = document.getElementById('questionsContainer');
            container.innerHTML = '';
            
            for (let i = 0; i < questionCount; i++) {
                const position = Math.floor(Math.random() * (questionMax - questionMin + 1)) + questionMin;
                // –î–ª—è —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –æ—Å—Ç–∞—Ç–æ–∫ –æ—Ç –¥–µ–ª–µ–Ω–∏—è (–ø–æ–∑–∏—Ü–∏—è - 1)
                const correctAnswer = currentSequence[(position - 1) % currentSequence.length];
                
                console.log(`–í–æ–ø—Ä–æ—Å ${i+1}: –ø–æ–∑–∏—Ü–∏—è ${position}, —Ü–∏–∫–ª –¥–ª–∏–Ω—ã ${currentSequence.length}, –æ—Å—Ç–∞—Ç–æ–∫ ${(position - 1) % currentSequence.length}, –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${correctAnswer}`);
                console.log('–¶–∏–∫–ª:', currentSequence);
                
                questions.push({
                    position: position,
                    correctAnswer: correctAnswer,
                    userAnswer: ''
                });
                
                // –°–æ–∑–¥–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ (–≤–∫–ª—é—á–∞—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∏ –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö)
                const options = generateQuestionOptions(correctAnswer);
                
                const questionDiv = document.createElement('div');
                questionDiv.className = 'question-item';
                questionDiv.innerHTML = `
                    <div class="question-text">–ö–∞–∫–æ–π ${position}-–π —ç–ª–µ–º–µ–Ω—Ç —Ü–∏–∫–ª–∏—á–µ—Å–∫–æ–π –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç–∏?</div>
                    <div class="question-options" id="options-${i}">
                        ${options.map((option, index) => 
                            `<div class="question-option" onclick="selectQuestionAnswer(${i}, '${option}')">${option}</div>`
                        ).join('')}
                    </div>
                    <div class="question-result" id="result-${i}"></div>
                `;
                container.appendChild(questionDiv);
            }
            
            updateStats();
        }

        function generateQuestionOptions(correctAnswer) {
            // –°–æ–∑–¥–∞–µ–º –º–∞—Å—Å–∏–≤ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –æ—Ç–≤–µ—Ç–æ–≤
            const options = [correctAnswer];
            
            // –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ —ç–º–æ–¥–∑–∏ –∏–∑ —Ü–∏–∫–ª–∞ (–∏—Å–∫–ª—é—á–∞—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π)
            const cycleEmojis = [...new Set(currentSequence)]; // –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ —ç–º–æ–¥–∑–∏ –∏–∑ —Ü–∏–∫–ª–∞
            const otherEmojis = cycleEmojis.filter(emoji => emoji !== correctAnswer);
            const shuffledOthers = [...otherEmojis].sort(() => Math.random() - 0.5);
            
            // –î–æ–±–∞–≤–ª—è–µ–º 2-3 –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–∞
            const wrongCount = Math.min(3, shuffledOthers.length);
            for (let i = 0; i < wrongCount; i++) {
                options.push(shuffledOthers[i]);
            }
            
            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã
            return options.sort(() => Math.random() - 0.5);
        }

        function selectQuestionAnswer(questionIndex, answer) {
            if (questions[questionIndex]) {
                const question = questions[questionIndex];
                const isCorrect = answer === question.correctAnswer;
                
                console.log(`–í–æ–ø—Ä–æ—Å ${questionIndex + 1}: –≤—ã–±—Ä–∞–Ω –æ—Ç–≤–µ—Ç ${answer}, –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç ${question.correctAnswer}, –ø—Ä–∞–≤–∏–ª—å–Ω–æ –ª–∏: ${isCorrect}`);
                
                question.userAnswer = answer;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –≤–∏–∑—É–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –∫–Ω–æ–ø–æ–∫
                const optionsContainer = document.getElementById(`options-${questionIndex}`);
                const options = optionsContainer.querySelectorAll('.question-option');
                
                options.forEach(option => {
                    option.classList.remove('selected', 'correct', 'incorrect');
                    if (option.textContent === answer) {
                        option.classList.add('selected');
                    }
                });
                
                if (isCorrect) {
                    // –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç - –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –∑–µ–ª–µ–Ω—ã–º
                    options.forEach(option => {
                        if (option.textContent === answer) {
                            option.classList.add('correct');
                        }
                    });
                } else {
                    // –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç - –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ–º –∫—Ä–∞—Å–Ω—ã–º –∏ —á–µ—Ä–µ–∑ 1.5 —Å–µ–∫ —É–±–∏—Ä–∞–µ–º
                    options.forEach(option => {
                        if (option.textContent === answer) {
                            option.classList.add('incorrect');
                        }
                    });
                    
                    setTimeout(() => {
                        options.forEach(option => {
                            option.classList.remove('incorrect', 'selected');
                        });
                        question.userAnswer = '';
                    }, 1500);
                }
            }
        }

        function showAnswers() {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –≤ –ø—Ä–æ–ø—É—Å–∫–∞—Ö
            showGapAnswers();
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –≤ –≤–æ–ø—Ä–æ—Å–∞—Ö
            showQuestionAnswers();
            
            updateStats();
        }

        function showGapAnswers() {
            const sequenceItems = document.querySelectorAll('.sequence-item');
            const cycleLength = currentSequence.length;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω–µ–∑–∞–ø–æ–ª–Ω–µ–Ω–Ω—ã—Ö –ø—Ä–æ–ø—É—Å–∫–æ–≤
            gapPositions.forEach(position => {
                const item = sequenceItems[position];
                if (item && (item.classList.contains('gap') || item.classList.contains('empty'))) {
                    // –í—ã—á–∏—Å–ª—è–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –¥–ª—è —ç—Ç–æ–π –ø–æ–∑–∏—Ü–∏–∏
                    const correctAnswer = currentSequence[position % cycleLength];
                    
                    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
                    item.textContent = correctAnswer;
                    item.classList.remove('gap', 'empty', 'selected', 'incorrect-gap');
                    item.classList.add('filled');
                    item.onclick = null;
                }
            });
        }

        function showQuestionAnswers() {
            questions.forEach((question, index) => {
                const resultDiv = document.getElementById(`result-${index}`);
                const optionsContainer = document.getElementById(`options-${index}`);
                const options = optionsContainer.querySelectorAll('.question-option');
                const isCorrect = question.userAnswer === question.correctAnswer;
                
                // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∏–ª–∏ –∫–Ω–æ–ø–æ–∫ - –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç
                options.forEach(option => {
                    option.classList.remove('correct', 'incorrect', 'selected');
                    if (option.textContent === question.correctAnswer) {
                        option.classList.add('correct');
                    }
                });
                
                if (isCorrect) {
                    correctAnswers++;
                    resultDiv.textContent = '‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!';
                    resultDiv.className = 'question-result correct';
                } else {
                    // –£–±–∏—Ä–∞–µ–º –Ω–∞–¥–ø–∏—Å—å –æ –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º –æ—Ç–≤–µ—Ç–µ, —Ç–∞–∫ –∫–∞–∫ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç –≤–∏–¥–µ–Ω –≤ –∫–Ω–æ–ø–∫–∞—Ö
                    resultDiv.textContent = '';
                    resultDiv.className = '';
                }
                resultDiv.style.display = 'block';
            });
        }

        function updateStats() {
            // –°—á–∏—Ç–∞–µ–º –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –æ—Ç–≤–µ—Ç—ã –≤ –ø—Ä–æ–ø—É—Å–∫–∞—Ö
            let correctGapAnswers = 0;
            const cycleLength = currentSequence.length;
            Object.keys(gapAnswers).forEach(position => {
                const userAnswer = gapAnswers[position];
                const correctAnswer = currentSequence[position % cycleLength];
                if (userAnswer === correctAnswer) {
                    correctGapAnswers++;
                }
            });
            
            document.getElementById('correctAnswers').textContent = correctAnswers + correctGapAnswers;
            document.getElementById('totalQuestions').textContent = questions.length;
            document.getElementById('filledGaps').textContent = filledGaps;
            document.getElementById('totalGaps').textContent = gapPositions.length + filledGaps;
        }

        function resetGame() {
            currentSequence = [];
            gapPositions = [];
            currentGapIndex = -1;
            questions = [];
            correctAnswers = 0;
            filledGaps = 0;
            gapAnswers = {};
            
            document.querySelector('.sequence').innerHTML = '';
            document.getElementById('questionsContainer').innerHTML = '';
            document.getElementById('choicePanel').style.display = 'none';
            
            updateStats();
        }
    </script>
</body>
</html>
